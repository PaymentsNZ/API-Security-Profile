{
  "definitions": {},
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://apicentre.paymentsnz.co.nz/schemas/CIBA-login-hint-schema.json",
  "type": "object",
  "title": "The schema for the CIBA request object login_hint_token",
  "additionalProperties": false,
  "required": ["subject"],
  "properties": {
    "subject": {
      "type": "object",
      "title": "Subject of the token",
      "required": ["subject_type"],
      "maxProperties": 2,
      "minProperties": 2,
      "additionalProperties": false,
      "properties": {
        "subject_type": {
          "type": "string",
          "title": "The type of subject hint",
          "enum": [
            "phone",
            "email",
            "username",
            "api_provider_token",
            "third_party_token"
          ]
        },
        "phone": {
          "type": "string",
          "title": "The phone of the subject identity to authorise",
          "pattern": "^\\+[0-9]{1,3}\\s?[0-9]{1,14}(\\s[0-9]{1,13})?$",
          "examples": ["+64 211011221", "+64211011221", "+64 21 1011221"]
        },
        "email": {
          "type": "string",
          "title": "The email of the subject identity to authorise",
          "format": "email",
          "examples": ["user@example.com"]
        },
        "username": {
          "type": "string",
          "title": "The username of the subject identity to authorise",
          "examples": ["user.name", "@handle"]
        },
        "api_provider_token": {
          "type": "string",
          "title": "A token generated by the customer authentication device",
          "description": "Uniquely identifies the Customer authentication device and Customer with the API Provider"
        },
        "third_party_token": {
          "type": "string",
          "title": "A token generated by the third party and registered with the customer authentication device",
          "pattern": "^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_.+/=]*$"
        }
      }
    },
    "aud": {
      "title": "The audiences for the login hint token",
      "description": "The value should be or include the API Provider Issuer Identifier URL",
      "oneOf": [
        {
          "type": "string",
          "examples": ["https://api.alphanbank.com"],
          "format": "uri"
        },
        {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^(.+)$"
          },
          "examples": ["https://api.alphanbank.com"]
        }
      ]
    },
    "iat":{
      "type": "integer",
      "description": "Time on which the login hint token was issued. May be used for determining age",
      "examples": [1496397168]
    },
    "exp": {
      "type": "integer",
      "description": "Expiration time on or after which the login hint token SHOULD NOT be accepted for processing.",
      "examples": [1496397168]
    },
    "nbf": {
      "type": "integer",
      "description": "Time before which the login hint token SHOULD NOT be accepted for processing.",
      "examples": [1496397168]
    },
    "iss": {
      "type": "string",
      "title": "The Issuer of the token",
      "description": "The value should be the client ID of the third party, unless signed by a different party",
      "default": "",
      "examples": ["s6BhdRkqt3"],
      "pattern": "^(.+)$"
    },
    "jti": {
      "type": "string",
      "title": "The unique identifier of the token",
      "description": "Used for determining token uniqueness. The value should be have sufficient entropy to make likelihood of collisions negligible.",
      "examples": ["d92f1393-752e-49c2-8ce3-90abc6b29655"]
    },
    "sub": {
      "type": "string",
      "description": "Subject Identifier, optionally to be consumed by the API provider",
      "examples": ["AItOawmwtWwcT0k51BayewNvutrJUqsvl6qs7A4"]
    }
  }
}
